# Week 4: Analytics Engineering - BigQuery, DBT
Setting up dbt cloud for a BigQuery data warehouse, creating a project, developing and deploying the models to production.  

## Setup
I am using the dbt cloud account (free for 1 developer) for BigQuery.
### Resources
* [creating a dbt account](https://www.getdbt.com/signup/)
* [BigQuery OAuth setup](https://docs.getdbt.com/docs/collaborate/manage-access/set-up-bigquery-oauth)
* [Youtube video on dbt and BigQuery setup](https://www.youtube.com/watch?v=6zDTbM6OUcs&ab_channel=JieJenn)

### Setup: BigQuery
* Ensure there is a service account with BigQuery Admin permissions  
* The JSON key generated by this service account will be needed for dbt setup  
* Ensure the [BigQuery API is enabled](https://console.cloud.google.com/apis/api/bigquery.googleapis.com)  
* Have all [trip data](https://github.com/DataTalksClub/nyc-tlc-data/) present in BigQuery including green taxi trips (2019, 2020), yellow taxi trips (2019, 2020), and fhv (2019)  
* Create a sandbox, staging, and production dataset schema in BigQuery for dbt  

### Setup: dbt
* Create dbt account  
* Create project and link JSON key generated previously  
* Link GitHub, create new repository if necessary  
* Initialize Project  
* Edit dbt_project.yaml name: 'taxi_rides_ny', update the name under models section to match, delete models/example/portion    

## dbt Basics  
Note that dbt uses a python language Jinja which it compiles and runs in the data warehouse.  
Eample:
```sql
---dbt sql model
{{
  config(materialized='table')
}}

SELECT  *
FROM    staging-source_table
WHERE   record_State = 'ACTIVE'
```
```sql
---compiled code
CREATE TABLE my_schema.my_model AS
(
  SELECT  *
  FROM    staging-source_table
  WHERE   record_State = 'ACTIVE'
)
```


## dbt model development
